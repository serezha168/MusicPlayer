# Документация по музыкальному плееру

## Основные компоненты

### MusicService

Сервис для управления музыкальными файлами.

Ключевые методы:

- `GetAllMusicFiles()`: Возвращает все загруженные музыкальные файлы.
- `LoadMusicFiles(string directoryPath)`: Загружает музыкальные файлы из указанной директории.
- `GetMusicFileByPath(string filePath)`: Возвращает музыкальный файл по указанному пути.

### AudioPlayerService

Сервис для воспроизведения аудио.

Ключевые методы:

- `LoadAudio(string filePath)`: Загружает аудиофайл для воспроизведения.
- `Play()`: Начинает воспроизведение.
- `Pause()`: Приостанавливает воспроизведение.
- `Stop()`: Останавливает воспроизведение.
- `SetVolume(float volume)`: Устанавливает громкость воспроизведения.
- `SetPosition(long position)`: Устанавливает позицию воспроизведения.
- `GetPosition()`: Возвращает текущую позицию воспроизведения.
- `GetLength()`: Возвращает общую длину аудиофайла.

### RelayCommand

Реализация команды для использования в MVVM паттерне.

Ключевые методы:

- `CanExecute(object? parameter)`: Проверяет, может ли команда быть выполнена.
- `Execute(object? parameter)`: Выполняет команду.
- `RaiseCanExecuteChanged()`: Уведомляет об изменении возможности выполнения команды.

### MainViewModel

Основной класс, отвечающий за логику приложения.

Ключевые свойства и методы:

- `IsPlaying`: Показывает, воспроизводится ли музыка в данный момент.
- `CurrentPosition`: Текущая позиция воспроизведения (от 0 до 1).
- `CurrentTime`: Текущее время воспроизведения в формате "мм:сс".
- `TotalTime`: Общая продолжительность трека в формате "мм:сс".
- `Volume`: Громкость воспроизведения (от 0 до 1).
- `IsUpdatingPosition`: Флаг, указывающий, обновляется ли позиция программно.
- `Play()`: Начинает воспроизведение.
- `Pause()`: Приостанавливает воспроизведение.
- `Stop()`: Останавливает воспроизведение.
- `OpenFile()`: Открывает диалог выбора аудиофайла.
- `SetPosition(double position)`: Устанавливает позицию воспроизведения.

## Новый функционал

### Загрузка музыкальных файлов

Теперь приложение может загружать музыкальные файлы из указанной директории.

### Улучшенное управление воспроизведением

Добавлены методы для более точного контроля над воспроизведением, включая установку позиции и громкости.

### Безопасная работа с null

Улучшена обработка null-значений во всем коде для предотвращения ошибок.

## Использование

1. Запустите приложение.
2. Используйте `MusicService` для загрузки музыкальных файлов.
3. Используйте `AudioPlayerService` для воспроизведения выбранного файла.
4. Управляйте воспроизведением через `MainViewModel`.

## Зависимости

Приложение использует библиотеку NAudio для работы с аудио.

## Примечания для разработчиков

- Используйте интерфейсы `IMusicService` и `IAudioPlayerService` для внедрения зависимостей.
- При работе с `RelayCommand` не забывайте вызывать `RaiseCanExecuteChanged()` при изменении условий выполнения команды.
- Обратите внимание на обработку исключений при работе с файлами в `MusicService`.